<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="0">
    <title>Axiom & Crucible - Character Sheet</title>
    <link rel="stylesheet" href="styles.css?v=4.0&platform=windows">
</head>
<body class="character-sheet-page">
    <!-- Top Navigation Bar -->
    <nav class="topbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h1>Axiom & Crucible</h1>
            </div>
            <div class="nav-links">
                <a href="index.html">Weapon Selection</a>
                <a href="rules.html">Rules</a>
                <a href="character-sheet.html" class="active">Character Sheet</a>
                <a href="combat.html">Combat Guide</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <header class="page-header">
            <h1>Axiom & Crucible Character Sheet</h1>
        </header>

        <!-- Character Sheet Form -->
        <div class="character-sheet">
            <!-- Top Row: Identity and Stats -->
            <div class="sheet-row top-row">
                <!-- Character Identity Section -->
                <section class="identity-section">
                    <h2>Operator Identity</h2>
                    <div class="identity-fields">
                        <div class="field-row">
                            <div class="field-group">
                                <label for="char-name">Name</label>
                                <input type="text" id="char-name" placeholder="Character Name">
                            </div>
                            <div class="field-group">
                                <label for="callsign">Callsign</label>
                                <input type="text" id="callsign" placeholder="Handle">
                            </div>
                        </div>
                        <div class="field-group">
                            <label for="concept">Concept/Role</label>
                            <input type="text" id="concept" placeholder="Primary function">
                        </div>
                        <div class="field-group">
                            <label for="background">Background</label>
                            <textarea id="background" rows="2" placeholder="Origin and history"></textarea>
                        </div>
                    </div>
                </section>

                <!-- Core Stats Section -->
                <section class="stats-section">
                    <h2>Core Stats</h2>
                    <div class="stats-row">
                        <div class="stat-block">
                            <label for="force">Force</label>
                            <input type="number" id="force" value="0" min="-3" max="5">
                            <span class="stat-desc">Instability tolerance</span>
                        </div>
                        <div class="stat-block">
                            <label for="resilience">Resilience</label>
                            <input type="number" id="resilience" value="0" min="-3" max="5">
                            <span class="stat-desc">Damage capacity</span>
                        </div>
                        <div class="stat-block">
                            <label for="precision">Precision</label>
                            <input type="number" id="precision" value="0" min="-3" max="5">
                            <span class="stat-desc">Accuracy & control</span>
                        </div>
                        <div class="stat-block">
                            <label for="adaptation">Adaptation</label>
                            <input type="number" id="adaptation" value="0" min="-3" max="5">
                            <span class="stat-desc">Recovery & stabilization</span>
                        </div>
                        <div class="stat-block">
                            <label for="cognition">Cognition</label>
                            <input type="number" id="cognition" value="0" min="-3" max="5">
                            <span class="stat-desc">Awareness & diagnostics</span>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Middle Row: Health Tracks and Derived Values -->
            <div class="sheet-row middle-row">
                <!-- Health Tracks -->
                <section class="health-section">
                    <h2>Health & Consequences</h2>
                    
                    <!-- Strain Track -->
                    <div class="track-container strain-container">
                        <div class="track-header">
                            <h3>Strain</h3>
                            <span class="track-formula">Max: 6 + Resilience = <span id="max-strain-display">6</span></span>
                        </div>
                        <div class="strain-track" id="strain-track"></div>
                        <div class="track-note">Clears after scenes â€¢ Overflow â†’ Injury</div>
                    </div>

                    <!-- Injury Track -->
                    <div class="track-container injury-container">
                        <div class="track-header">
                            <h3>Injury</h3>
                            <span class="track-formula">Max: 2 + âŒŠResilience/2âŒ‹ = <span id="max-injuries-display">2</span></span>
                        </div>
                        <div class="injury-track" id="injury-track"></div>
                        <div class="track-note">Persistent â€¢ No generic penalties</div>
                    </div>

                    <!-- Trauma Track -->
                    <div class="track-container trauma-container">
                        <div class="track-header">
                            <h3>Trauma</h3>
                            <span class="track-formula">Fixed: 2 slots</span>
                        </div>
                        <div class="trauma-track">
                            <div class="trauma-slot">
                                <input type="checkbox" id="trauma-1">
                                <input type="text" placeholder="Permanent change description">
                            </div>
                            <div class="trauma-slot">
                                <input type="checkbox" id="trauma-2">
                                <input type="text" placeholder="Permanent change description">
                            </div>
                        </div>
                        <div class="track-note warning">Permanent â€¢ System-defining â€¢ Death if full</div>
                    </div>
                </section>

                <!-- Weapon Configuration -->
                <section class="weapon-section" style="color: white !important;">
                    <h2 style="color: #00d4ff !important;">Weapon Configuration</h2>
                    <div class="weapon-import-row">
                        <button id="import-weapon" class="import-btn">Import Build</button>
                        <button id="roll-dice" class="roll-btn">ðŸŽ² Roll Dice</button>
                    </div>
                    
                    <div class="weapon-config-grid">
                        <div class="weapon-platform" style="color: white !important;">
                            <h4 style="color: #00d4ff !important;">Platform</h4>
                            <input type="text" id="weapon-platform" placeholder="Ranged/Melee">
                            <textarea id="platform-features" rows="2" placeholder="Platform features"></textarea>
                        </div>
                        
                        <div class="weapon-module" style="color: white !important;">
                            <h4 style="color: #00d4ff !important;">Module</h4>
                            <input type="text" id="weapon-module" placeholder="Module name">
                            <textarea id="module-effect" rows="2" placeholder="Module effect"></textarea>
                        </div>
                    </div>

                    <div class="weapon-stats-row">
                        <div class="weapon-stat">
                            <label>Difficulty</label>
                            <input type="number" id="weapon-difficulty" value="10" min="1" max="30">
                        </div>
                        <div class="weapon-stat">
                            <label>Damage</label>
                            <input type="text" id="weapon-damage" value="1d6">
                        </div>
                        <div class="weapon-stat">
                            <label>Instability Gauge</label>
                            <input type="number" id="instability-gauge" value="3" min="1" max="10">
                        </div>
                    </div>
                </section>
            </div>

            <!-- Bottom Row: Weapon Instability and Actions -->
            <div class="sheet-row bottom-row">
                <!-- Weapon Instability Track -->
                <section class="instability-section">
                    <h2>Weapon Instability</h2>
                    <div class="instability-container">
                        <div class="instability-track" id="weapon-instability-track"></div>
                        <div class="instability-controls">
                            <button id="clear-instability" class="control-btn">Clear</button>
                            <button id="add-instability" class="control-btn">+1</button>
                        </div>
                        <div class="instability-status">
                            <strong>Status:</strong> <span id="instability-status">Stable</span>
                        </div>
                        <div class="instability-warning">If Instability > Force during failure, consequences escalate</div>
                    </div>
                </section>

                <!-- Actions -->
                <section class="actions-section">
                    <h2>Actions</h2>
                    <div class="action-grid">
                        <button id="save-character" class="action-btn">Save</button>
                        <button id="load-character" class="action-btn">Load</button>
                        <button id="export-pdf" class="action-btn">Export</button>
                        <button id="reset-sheet" class="action-btn danger">Reset</button>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Dice Rolling Modal -->
    <div id="dice-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ðŸŽ² Dice Roller</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="dice-controls">
                <div class="dice-tabs">
                    <button class="tab-btn active" data-tab="dice">Dice Rolling</button>
                    <button class="tab-btn" data-tab="presets">Presets</button>
                </div>
                
                <!-- Dice Rolling Tab -->
                <div id="dice-tab" class="tab-content active">
                    <div class="dice-expression-builder">
                        <div class="dice-expression-input">
                            <label for="dice-expression">Dice Expression:</label>
                            <input type="text" id="dice-expression" placeholder="1d20+5 or 1d6+1d4+2" 
                                   title="Examples: 1d20+5, 1d6+1d4, 2d8+1d10+3">
                        </div>
                        <div class="quick-add-dice">
                            <span>Add Dice:</span>
                            <button class="quick-dice" data-sides="4">+d4</button>
                            <button class="quick-dice" data-sides="6">+d6</button>
                            <button class="quick-dice" data-sides="8">+d8</button>
                            <button class="quick-dice" data-sides="10">+d10</button>
                            <button class="quick-dice" data-sides="12">+d12</button>
                            <button class="quick-dice" data-sides="20">+d20</button>
                            <button class="quick-dice" data-sides="100">+d100</button>
                        </div>
                        <div class="modifier-controls">
                            <span>Add Modifier:</span>
                            <button class="modifier-btn" data-mod="+1">+1</button>
                            <button class="modifier-btn" data-mod="+2">+2</button>
                            <button class="modifier-btn" data-mod="+3">+3</button>
                            <button class="modifier-btn" data-mod="+5">+5</button>
                            <button class="modifier-btn" data-mod="-1">-1</button>
                            <button class="modifier-btn" data-mod="-2">-2</button>
                        </div>
                        <div class="expression-actions">
                            <button id="clear-expression" class="action-btn">Clear</button>
                            <button id="save-preset-from-dice" class="action-btn">Save as Preset</button>
                        </div>
                    </div>
                    <button id="execute-dice-roll" class="execute-roll-btn">Roll!</button>
                </div>
                
                <!-- Presets Tab -->
                <div id="presets-tab" class="tab-content">
                    <div class="preset-creator">
                        <div class="preset-input-group">
                            <label for="preset-name">Preset Name:</label>
                            <input type="text" id="preset-name" placeholder="e.g., Attack Roll, Damage">
                        </div>
                        <div class="preset-input-group">
                            <label for="preset-expression">Dice Expression:</label>
                            <input type="text" id="preset-expression" placeholder="1d20+5">
                        </div>
                        <button id="save-preset" class="action-btn">Save Preset</button>
                    </div>
                    <div class="preset-list" id="preset-list">
                        <!-- Presets will be populated here -->
                    </div>
                </div>
            </div>
            <div class="dice-animation-area">
                <div id="dice-display" class="dice-display"></div>
                <div id="dice-result" class="dice-result"></div>
            </div>
            <div class="dice-history">
                <h4>Recent Rolls</h4>
                <div id="roll-history" class="roll-history-list"></div>
            </div>
        </div>
    </div>

    <script src="character-sheet.js"></script>
</body>
</html>
